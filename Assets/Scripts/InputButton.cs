using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.UI;
using System.Linq;
using TMPro;
public class InputButton : MonoBehaviour
{
    public GameObject OnScreenKeyboard; 
    public GameObject selfButton;
    public List<string> roomList ;
    public TMP_Dropdown dropdown;
    void Start(){
        selfButton = this.gameObject;
        roomList = new List<string>(){"132",
"131",
"130",
"129",
"128",
"127",
"126",
"125",
"124",
"123",
"122",
"121",
"120",
"119",
"118",
"117",
"116",
"115",
"114",
"113",
"112",
"111",
"110",
"189",
"188",
"187",
"173",
"162",
"171",
"163",
"164",
"109",
"165",
"183",
"184",
"185",
"186",
"182",
"181",
"180",
"179",
"178",
"177",
"176",
"175",
"174",
"172",
"170",
"101",
"141",
"142",
"143",
"145",
"147",
"148",
"149",
"146",
"150",
"144",
"140",
"152",
"154",
"159",
"158",
"156",
"100",
"103",
"297",
"257",
"259",
"233",
"232",
"231",
"230",
"229",
"228",
"227",
"226",
"225",
"224",
"223",
"222",
"221",
"220",
"219",
"218",
"217",
"216",
"215",
"214",
"213",
"212",
"211",
"210",
"261",
"262",
"260",
"277",
"275",
"263",
"264",
"209",
"271",
"273",
"270",
"272",
"274",
"280",
"281",
"282",
"283",
"276",
"278",
"200",
"287",
"205",
"289",
"285",
"290",
"299",
"241",
"243",
"240",
"245",
"247",
"246",
"253",
"250",
"250",
"249",
"255",
"208",
"258",
"256",
"254",
"252",
"340",
"341",
"343",
"345",
"347",
"349",
"348",
"346",
"359",
"358",
"357",
"356",
"350",
"354",
"352",
"302",
"351",
"353",
"355",
"308",
"321",
"322",
"323",
"324",
"325",
"326",
"327",
"328",
"329",
"330",
"331",
"370",
"372",
"371",
"377",
"301",
"362",
"363",
"364",
"365",
"309",
"300",
"320",
"319",
"318",
"317",
"316",
"315",
"314",
"313",
"312",
"311",
"310",
"360",
"390",
"388",
"386",
"385",
"387",
"389",
"391",
"382",
"381",
"380",
"398",
"379",
"374",
"378",
"384"};
        dropdown.onValueChanged.AddListener(delegate { OnDropdownValueChange(); });
    }


    void OnDropdownValueChange() {
        
        if(dropdown.IsExpanded){
            int selectedIndex = dropdown.value;
            string selectedValue = dropdown.options[selectedIndex].text;
            transform.Find("TextVal").GetComponent<TextMeshProUGUI>().text = selectedValue;
        }
        
    }
    public void selected(){
        selfButton.transform.Find("TextVal").GetComponent<TextMeshProUGUI>().text = "";
        OnScreenKeyboard.SetActive(true);
        if(OnScreenKeyboard.gameObject.transform.GetChild(0).transform.GetComponent<key>().Holder != null){
            OnScreenKeyboard.gameObject.transform.GetChild(0).transform.GetComponent<key>().Holder.transform.Find("arrow").gameObject.SetActive(false);
        }
        foreach(Transform child in OnScreenKeyboard.gameObject.transform){
            child.transform.GetComponent<key>().Holder = this.gameObject;
        }
        this.gameObject.transform.Find("arrow").gameObject.SetActive(true);
    }
    public void InvokeSearch(){ 
        List<string> matches = roomList.Where(item => item.StartsWith(transform.Find("TextVal").GetComponent<TextMeshProUGUI>().text)).ToList();
        dropdown.ClearOptions();
        dropdown.AddOptions(matches);
        dropdown.value = -1;
        
    }
    
}
